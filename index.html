
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Dramagrama</title>
	<meta name="description" content="">
	<meta name="author" content="">

	<link href="lib/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet/less" type="text/css" href="style.less">

	<script src="lib/less-1.3.0.min.js" type="text/javascript"></script>
	<script src="lib/raphael-min.js" type="text/javascript"></script>

	<script src="lib/coffee-script.js" type="text/javascript"></script>
	<script src="dramagrama.coffee" type="text/coffeescript"></script>
	
	<link href='http://fonts.googleapis.com/css?family=Yanone+Kaffeesatz' rel='stylesheet' type='text/css'>
	<link href='http://fonts.googleapis.com/css?family=Shadows+Into+Light+Two' rel='stylesheet' type='text/css'>
</head>

<body>

	<div class="hero-unit">
		<img src="logo.png" height="60" width="60" style="float: left"></img>
		<div class="toptitle">diagramophone<br/>
		<span class="subtitle"> [ because I <i>really</i> hate drawing diagrams ]</span>
		</div>
		
	</div>

	<div class="wrap">
	<div class="left-column">
		<div class="title" style="overflow:hidden">Code your diagram here 
			<button class="btn btn-primary btn-mini" id="diagramophone" style="float: right">GO</button>
			<label class="checkbox" style="float: right; margin-right: 20px">
          		<input type="checkbox" id="repl">REPL
        	</label>
		</div>	
		<textarea style="width:390px" id="textarea" rows="20"></textarea>

	</div>

	<div class="right-column">
		<div class="title">Image comes out here</div>
		<div id="canvas"> </div>
	</div>
	
	</div>
</body>
<script type="text/coffeescript">
@controller = new Controller

paper = Raphael "canvas", 400, 400

sampleText = """
// basic blocks, with arrow or diamond connectors
block 1 -<> block 2.1
block 1 -> block 2.2

// arrows could have messages
block 3 -> block 4 {red} : hey there!

// look, dashed lines!
block 2.2 ..> block 6 : arrowMsg3

// and also colours -- css names or hex
block 4 {#ffb700} ..> block 5 {red} : arrowMsg4

// you can define blocks to be standalone and use them later
// useful if you want to define and style your blocks first
// and then draw the connections
block 7
block 8 {blue}
block 7 -> block 8
"""

btn = document.getElementById("diagramophone")
textarea = document.getElementById("textarea")
repl = document.getElementById("repl")

btn.addEventListener 'click', => @controller.makeItGo(textarea.value, paper)
textarea.addEventListener 'keyup', => 
	if (repl.checked)
		@controller.makeItGo(textarea.value, paper)

textarea.value = sampleText
	
@controller.makeItGo(textarea.value, paper)

</script>
</html>

